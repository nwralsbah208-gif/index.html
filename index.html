<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>ŸÑÿπÿ®ÿ© ÿßŸÑŸÖÿ±ÿ®ÿπ ÿßŸÑÿ£ÿ≠ŸÖÿ±</title>
<style>
body {
  margin: 0;
  background: #111;
  overflow: hidden;
  font-family: Arial;
}
canvas {
  display: block;
  background: #222;
}

/* ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ¨ŸàÿßŸÑ */
.controls {
  position: fixed;
  bottom: 10px;
  left: 10px;
  display: grid;
  grid-template-columns: 60px 60px 60px;
  grid-template-rows: 60px 60px;
  gap: 5px;
}
.controls button,
.fire {
  width: 60px;
  height: 60px;
  font-size: 22px;
  background: #444;
  color: white;
  border: none;
  border-radius: 10px;
}
.fire {
  position: fixed;
  bottom: 30px;
  right: 20px;
  width: 80px;
  height: 80px;
  background: darkred;
}
</style>
</head>
<body>

<canvas id="game"></canvas>

<!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ≠ÿ±ŸÉÿ© -->
<div class="controls">
  <div></div>
  <button id="up">‚¨ÜÔ∏è</button>
  <div></div>
  <button id="left">‚¨ÖÔ∏è</button>
  <button id="down">‚¨áÔ∏è</button>
  <button id="right">‚û°Ô∏è</button>
</div>

<!-- ÿ≤ÿ± ÿ•ÿ∑ŸÑÿßŸÇ -->
<button class="fire" id="fire">üî•</button>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let gameOver = false;

// ÿßŸÑŸÑÿßÿπÿ®
const player = {
  x: canvas.width/2,
  y: canvas.height/2,
  size: 30,
  speed: 4,
  hearts: 3
};

// ÿßŸÑÿ±ÿµÿßÿµ
let bullets = [];

// ÿßŸÑŸàÿ≠Ÿàÿ¥
let monsters = [];

function spawnMonster() {
  monsters.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    size: 30,
    speed: 1.5
  });
}

setInterval(spawnMonster, 1500);

// ÿ™ÿ≠ŸÉŸÖ
let move = {up:false,down:false,left:false,right:false};

document.getElementById("up").ontouchstart = ()=>move.up=true;
document.getElementById("down").ontouchstart = ()=>move.down=true;
document.getElementById("left").ontouchstart = ()=>move.left=true;
document.getElementById("right").ontouchstart = ()=>move.right=true;

document.getElementById("up").ontouchend =
document.getElementById("down").ontouchend =
document.getElementById("left").ontouchend =
document.getElementById("right").ontouchend = ()=>move={up:false,down:false,left:false,right:false};

document.getElementById("fire").ontouchstart = ()=>{
  bullets.push({
    x: player.x,
    y: player.y,
    dx: 8,
    dy: 0
  });
};

function update() {
  if (gameOver) return;

  if (move.up) player.y -= player.speed;
  if (move.down) player.y += player.speed;
  if (move.left) player.x -= player.speed;
  if (move.right) player.x += player.speed;

  bullets.forEach(b=> b.x += b.dx);

  monsters.forEach(m=>{
    const dx = player.x - m.x;
    const dy = player.y - m.y;
    const dist = Math.hypot(dx,dy);
    m.x += dx/dist * m.speed;
    m.y += dy/dist * m.speed;

    if (dist < 30) {
      player.hearts--;
      m.x = -100;
      if (player.hearts <= 0) {
        gameOver = true;
      }
    }
  });

  bullets.forEach((b,bi)=>{
    monsters.forEach((m,mi)=>{
      if (Math.hypot(b.x-m.x,b.y-m.y)<20){
        monsters.splice(mi,1);
        bullets.splice(bi,1);
      }
    });
  });
}

function draw() {
  if (gameOver) {
    ctx.fillStyle="black";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="red";
    ctx.font="40px Arial";
    ctx.fillText("üíÄ ÿÆÿ≥ÿ±ÿ™", canvas.width/2-60, canvas.height/2);
    return;
  }

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // ÿßŸÑŸÑÿßÿπÿ®
  ctx.fillStyle="red";
  ctx.fillRect(player.x,player.y,player.size,player.size);

  // ÿßŸÑÿ±ÿµÿßÿµ
  ctx.fillStyle="yellow";
  bullets.forEach(b=>ctx.fillRect(b.x,b.y,10,4));

  // ÿßŸÑŸàÿ≠Ÿàÿ¥
  ctx.fillStyle="green";
  monsters.forEach(m=>ctx.fillRect(m.x,m.y,m.size,m.size));

  // ÿßŸÑŸÇŸÑŸàÿ®
  ctx.fillStyle="white";
  ctx.fillText("‚ù§Ô∏è ".repeat(player.hearts),20,30);
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
