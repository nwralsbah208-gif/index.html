<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Red Square VS Souls</title>
<style>
body{margin:0;background:#000;overflow:hidden;font-family:Tahoma}
canvas{display:block;margin:auto;background:#111}
#menu{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:#000;color:#fff;text-align:center;
}
.level{
  padding:10px;margin:5px;border:1px solid #555;
  display:inline-block;width:120px;cursor:pointer;
}
.locked{opacity:.3}
</style>
</head>
<body>

<div id="menu">
  <h1>ðŸŸ¥ Red Square VS Souls</h1>
  <p>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø­Ù„Ø©</p>
  <div id="levels"></div>
</div>

<canvas id="game" width="900" height="500"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const menu=document.getElementById("menu");
const levelsDiv=document.getElementById("levels");

let currentLevel=0;
let unlocked=1;

// ===== Ø§Ù„Ù„Ø§Ø¹Ø¨ =====
const player={
  x:100,y:350,w:40,h:40,
  speed:4,hp:3,bullets:[]
};

// ===== ØªØ­ÙƒÙ… =====
const keys={};
onkeydown=e=>keys[e.key]=true;
onkeyup=e=>keys[e.key]=false;

// ===== Ù…Ø±Ø§Ø­Ù„ =====
const levels=[
 {name:"Ø§Ù„Ø¸Ù„ Ø§Ù„Ø¶Ø¹ÙŠÙ",hp:20,spd:2,msg:"Ø³ÙˆÙ Ø£Ø¯Ù…Ø±Ùƒ"},
 {name:"Ø§Ù„Ø¹ÙŠÙ† Ø§Ù„Ø­Ù…Ø±Ø§Ø¡",hp:30,spd:2.5,msg:"Ø£Ø±Ø§Ùƒ"},
 {name:"Ø§Ù„Ù‚Ø§ÙØ²",hp:40,spd:3,msg:"Ù„Ù† ØªÙ‡Ø±Ø¨"},
 {name:"Ø§Ù„Ø­Ø§Ø±Ù‚",hp:45,spd:3,msg:"Ø§Ø­ØªØ±Ù‚"},
 {name:"Ø§Ù„Ø³Ø±ÙŠØ¹",hp:50,spd:3.5,msg:"Ø£Ø³Ø±Ø¹ Ù…Ù†Ùƒ"},
 {name:"Ø§Ù„ØµØ§Ù…Øª",hp:55,spd:2.5,msg:"..."},
 {name:"Ø§Ù„Ù…Ø¬Ù†Ø­",hp:60,spd:4,msg:"Ø£Ø·ÙŠØ±"},
 {name:"Ø§Ù„Ù…Ø¯Ù…Ø±",hp:70,spd:3,msg:"Ø³Ø£ÙƒØ³Ø± ÙƒÙ„ Ø´ÙŠØ¡"},
 {name:"Ø§Ù„Ø³Ø§Ù…",hp:80,spd:3,msg:"Ø³Ù…ÙŠ Ù‚Ø§ØªÙ„"},
 {name:"Ø§Ù„Ø´ÙŠØ·Ø§Ù†",hp:90,spd:3.5,msg:"Ø§Ù„Ø¬Ø­ÙŠÙ… ÙŠÙ†ØªØ¸Ø±Ùƒ"},
 {name:"Ø§Ù„Ø±ÙˆØ­ Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡",hp:100,spd:4,msg:"Ù†Ù‡Ø§ÙŠØªÙƒ Ù‚Ø±ÙŠØ¨Ø©"},
 {name:"Ø§Ù„Ø­Ø§Ø±Ø³",hp:120,spd:3,msg:"Ù„Ø§ Ù…Ø±ÙˆØ±"},
 {name:"Ø§Ù„Ù…Ù„Ùƒ",hp:150,spd:3,msg:"Ø£Ù†Ø§ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©"}
];

let enemy=null;
let souls=[];

// ===== Ù‚Ø§Ø¦Ù…Ø© =====
function drawMenu(){
  levelsDiv.innerHTML="";
  levels.forEach((l,i)=>{
    const d=document.createElement("div");
    d.className="level"+(i>=unlocked?" locked":"");
    d.textContent=`Ù…Ø±Ø­Ù„Ø© ${i+1}`;
    if(i<unlocked){
      d.onclick=()=>startLevel(i);
    }
    levelsDiv.appendChild(d);
  });
}
drawMenu();

// ===== Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© =====
function startLevel(i){
  currentLevel=i;
  menu.style.display="none";
  player.hp=3;
  player.x=100;
  player.bullets=[];
  const l=levels[i];
  enemy={
    x:600,y:350,w:50,h:50,
    hp:l.hp,speed:l.spd,
    msg:l.msg, jump:0
  };
}

// ===== Ø¥Ø·Ù„Ø§Ù‚ =====
function shoot(){
  player.bullets.push({x:player.x+40,y:player.y+20});
}

// ===== ØªØ­Ø¯ÙŠØ« =====
function update(){
  if(keys["ArrowLeft"])player.x-=player.speed;
  if(keys["ArrowRight"])player.x+=player.speed;
  if(keys["ArrowUp"])player.y-=player.speed;
  if(keys["ArrowDown"])player.y+=player.speed;
  if(keys[" "])shoot();

  // Ø±ØµØ§Øµ
  player.bullets.forEach(b=>b.x+=7);
  player.bullets=player.bullets.filter(b=>b.x<canvas.width);

  // Ø°ÙƒØ§Ø¡ Ø§Ù„ÙˆØ­Ø´
  if(enemy){
    enemy.x+=enemy.x>player.x?-enemy.speed:enemy.speed;
    if(Math.random()<0.01)enemy.jump=20;
    if(enemy.jump>0){enemy.y-=2;enemy.jump--}
    if(enemy.y<350)enemy.y+=2;

    // ØªØµØ§Ø¯Ù…
    if(
      player.x<enemy.x+enemy.w &&
      player.x+player.w>enemy.x &&
      player.y<enemy.y+enemy.h &&
      player.y+player.h>enemy.y
    ){
      player.hp--;
      player.x=50;
      if(player.hp<=0){
        menu.style.display="block";
        drawMenu();
      }
    }

    // Ø¥ØµØ§Ø¨Ø©
    player.bullets.forEach(b=>{
      if(b.x>enemy.x && b.x<enemy.x+enemy.w &&
         b.y>enemy.y && b.y<enemy.y+enemy.h){
        enemy.hp--;
        b.x=9999;
      }
    });

    // Ù…ÙˆØª Ø§Ù„ÙˆØ­Ø´
    if(enemy.hp<=0){
      souls.push({x:enemy.x,y:enemy.y,life:100});
      enemy=null;
      if(unlocked<levels.length)unlocked++;
      menu.style.display="block";
      drawMenu();
    }
  }

  // Ø§Ù„Ø£Ø±ÙˆØ§Ø­
  souls.forEach(s=>{s.y-=1;s.life--});
  souls=souls.filter(s=>s.life>0);
}

// ===== Ø±Ø³Ù… =====
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Ù„Ø§Ø¹Ø¨
  ctx.fillStyle="red";
  ctx.fillRect(player.x,player.y,player.w,player.h);

  // Ù‚Ù„ÙˆØ¨
  for(let i=0;i<player.hp;i++){
    ctx.fillStyle="pink";
    ctx.fillRect(20+i*25,20,20,20);
  }

  // Ø±ØµØ§Øµ
  ctx.fillStyle="yellow";
  player.bullets.forEach(b=>ctx.fillRect(b.x,b.y,6,3));

  // ÙˆØ­Ø´
  if(enemy){
    ctx.fillStyle="darkgreen";
    ctx.fillRect(enemy.x,enemy.y,enemy.w,enemy.h);

    // Ø¹ÙŠÙˆÙ†
    ctx.fillStyle="white";
    ctx.fillRect(enemy.x+10,enemy.y+10,5,5);
    ctx.fillRect(enemy.x+30,enemy.y+10,5,5);

    // ÙƒÙ„Ø§Ù…
    ctx.fillStyle="red";
    ctx.fillText(enemy.msg,enemy.x-10,enemy.y-10);
  }

  // Ø±ÙˆØ­
  souls.forEach(s=>{
    ctx.fillStyle="rgba(0,255,255,.5)";
    ctx.beginPath();
    ctx.arc(s.x,s.y,15,0,Math.PI*2);
    ctx.fill();
  });
}

// ===== Ø­Ù„Ù‚Ø© =====
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
