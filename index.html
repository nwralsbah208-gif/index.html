<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ULTRA JUMP EXTREME PRO</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background: #000;
    overflow: hidden;
    font-family: 'Arial', sans-serif;
    touch-action: manipulation;
}

canvas {
    display: block;
    background: #000;
    filter: contrast(1.1) brightness(1.1);
}

#ui {
    position: fixed;
    top: 20px;
    left: 20px;
    color: #0f0;
    font-family: 'Courier New', monospace;
    font-size: 18px;
    background: rgba(0, 0, 0, 0.85);
    padding: 15px 20px;
    border-radius: 12px;
    z-index: 100;
    border: 2px solid #0f0;
    box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
    backdrop-filter: blur(10px);
    min-width: 220px;
}

#ui h1 {
    color: #ff0;
    font-size: 1.8em;
    margin-bottom: 15px;
    text-align: center;
    text-shadow: 0 0 10px #ff0;
}

#ui div {
    margin: 8px 0;
    display: flex;
    justify-content: space-between;
}

#ui span {
    color: #fff;
    font-weight: bold;
}

#over {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle, rgba(255, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.95) 100%);
    color: white;
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 1000;
    animation: fadeIn 0.5s;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

#over h1 {
    color: #fff;
    font-size: 4.5em;
    margin-bottom: 30px;
    text-shadow: 0 0 30px #ff0000, 0 0 60px #ff0000;
    animation: glow 2s infinite alternate;
}

@keyframes glow {
    from { text-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000; }
    to { text-shadow: 0 0 30px #ff0000, 0 0 60px #ff0000; }
}

#over p {
    font-size: 2em;
    margin: 15px 0;
    text-shadow: 0 0 10px #fff;
}

#over button {
    background: linear-gradient(45deg, #ff0000, #ff8800);
    color: white;
    border: none;
    padding: 18px 45px;
    font-size: 1.4em;
    border-radius: 50px;
    cursor: pointer;
    margin: 20px;
    font-weight: bold;
    transition: all 0.3s;
    box-shadow: 0 0 25px rgba(255, 0, 0, 0.5);
}

#over button:hover {
    transform: scale(1.1);
    box-shadow: 0 0 35px rgba(255, 0, 0, 0.7);
}

#startScreen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle at center, #000428 0%, #004e92 100%);
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 2000;
    animation: starfield 20s linear infinite;
}

@keyframes starfield {
    from { background-position: 0 0; }
    to { background-position: 1000px 1000px; }
}

#startScreen h1 {
    color: #0f0;
    font-size: 5em;
    margin-bottom: 40px;
    text-shadow: 0 0 30px #0f0, 0 0 60px #0f0;
    animation: titleGlow 3s infinite alternate;
}

@keyframes titleGlow {
    0% { transform: scale(1); text-shadow: 0 0 20px #0f0; }
    50% { transform: scale(1.05); text-shadow: 0 0 40px #0f0, 0 0 80px #0f0; }
    100% { transform: scale(1); text-shadow: 0 0 20px #0f0; }
}

#startScreen button {
    background: linear-gradient(45deg, #00ff00, #00cc00);
    color: black;
    border: none;
    padding: 20px 60px;
    font-size: 1.8em;
    border-radius: 50px;
    cursor: pointer;
    margin: 30px;
    font-weight: bold;
    transition: all 0.3s;
    box-shadow: 0 0 30px rgba(0, 255, 0, 0.5);
}

#startScreen button:hover {
    transform: scale(1.1);
    box-shadow: 0 0 50px rgba(0, 255, 0, 0.8);
}

#instructions {
    margin-top: 40px;
    text-align: center;
    color: #ccc;
    max-width: 600px;
    line-height: 2;
    font-size: 1.2em;
    background: rgba(0, 0, 0, 0.6);
    padding: 25px;
    border-radius: 15px;
    border: 2px solid rgba(0, 255, 0, 0.3);
}

#instructions p {
    margin: 12px 0;
}

#instructions span {
    color: #ff0;
    font-weight: bold;
}

#audioControl {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 100;
    background: rgba(0, 0, 0, 0.7);
    border: 2px solid #0f0;
    border-radius: 50px;
    padding: 10px;
    cursor: pointer;
    transition: all 0.3s;
}

#audioControl:hover {
    transform: scale(1.1);
    box-shadow: 0 0 20px #0f0;
}

#comboDisplay {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #ff0;
    font-size: 0;
    font-weight: bold;
    text-shadow: 0 0 20px #ff0, 0 0 40px #ff0;
    display: none;
    z-index: 150;
    pointer-events: none;
    animation: comboPop 0.8s ease-out;
}

@keyframes comboPop {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
    50% { opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
}

#shakeEffect {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 50;
    display: none;
}

#cameraView {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}
</style>
</head>
<body>

<div id="startScreen">
    <h1>ğŸ® ULTRA JUMP EXTREME PRO</h1>
    <button id="startButton">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø©</button>
    <div id="instructions">
        <p>ğŸ¯ <span>Ø§Ù„Ù‡Ø¯Ù:</span> ØªØ¬Ù†Ø¨ Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª ÙˆØ§Ø¬Ù…Ø¹ Ø§Ù„Ù‚ÙˆÙ‰ Ù„Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ù†Ù‚Ø§Ø·!</p>
        <p>ğŸ”¼ <span>Ø§Ù„ØªØ­ÙƒÙ…:</span> SPACE Ø£Ùˆ Ø§Ù„Ù†Ù‚Ø± Ù„Ù„Ù‚ÙØ² (Ù‚ÙØ²ØªØ§Ù† ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰)</p>
        <p>âœ¨ <span>Ø§Ù„Ù‚ÙˆÙ‰ Ø§Ù„Ø®Ø§ØµØ©:</span></p>
        <p>ğŸ”· Ø£Ø²Ø±Ù‚ = Ø¯Ø±Ø¹ ğŸ”· | ğŸŸ¡ Ø£ØµÙØ± = Ù‚ÙØ²Ø© Ø¥Ø¶Ø§ÙÙŠØ© ğŸ”·</p>
        <p>ğŸŸ  Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ = Ù…ØºÙ†Ø§Ø·ÙŠØ³ ğŸ”· | ğŸŸ¢ Ø£Ø®Ø¶Ø± = Ø¹Ù…Ù„Ø§Øª Ù…Ø²Ø¯ÙˆØ¬Ø©</p>
        <p>ğŸ’€ <span>Ø§Ø­Ø°Ø±:</span> Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ ØªÙ†Ù‡ÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©!</p>
    </div>
</div>

<canvas id="gameCanvas"></canvas>

<div id="ui">
    <h1>ğŸ® ULTRA JUMP PRO</h1>
    <div>ğŸ† <span>Ø§Ù„Ù†Ù‚Ø§Ø·:</span> <span id="score">0</span></div>
    <div>ğŸ’° <span>Ø§Ù„Ø¹Ù…Ù„Ø§Øª:</span> <span id="coins">0</span></div>
    <div>ğŸ‘Ÿ <span>Ø§Ù„Ù‚ÙØ²Ø§Øª:</span> <span id="jumps">2</span></div>
    <div>âš¡ <span>Ø§Ù„Ø³Ø±Ø¹Ø©:</span> <span id="speed">4.0</span></div>
    <div>â±ï¸ <span>Ø§Ù„ÙˆÙ‚Øª:</span> <span id="time">00:00</span></div>
</div>

<div id="over">
    <h1>ğŸ’€ GAME OVER</h1>
    <p>ğŸ† Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="finalScore">0</span></p>
    <p>â­ Ø§Ù„Ø£Ø¹Ù„Ù‰: <span id="highScore">0</span></p>
    <button id="restartButton">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</button>
    <button id="menuButton">ğŸ  Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
</div>

<div id="audioControl" onclick="toggleAudio()">ğŸ”Š</div>
<div id="comboDisplay"></div>
<div id="shakeEffect"></div>
<div id="cameraView"></div>

<script>
// ==================== Ø¶Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£ÙˆÙ„Ø§Ù‹ ====================
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('startButton').addEventListener('click', function(e) {
        console.log('Start button clicked');
        startGame();
        e.stopPropagation();
    });
    
    document.getElementById('restartButton').addEventListener('click', restartGame);
    document.getElementById('menuButton').addEventListener('click', goToMenu);
    
    document.getElementById('gameCanvas').addEventListener('click', jump);
});

// ==================== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ====================
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const startScreen = document.getElementById('startScreen');
const gameOverScreen = document.getElementById('over');
const comboDisplay = document.getElementById('comboDisplay');
const shakeEffect = document.getElementById('shakeEffect');
const audioControl = document.getElementById('audioControl');

// ==================== Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª ÙˆØ§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ====================
let audioEnabled = true;
let audioContext = null;
let backgroundMusic = null;

function initAudio() {
    try {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
    } catch(e) {
        console.log("Audio not supported");
        audioEnabled = false;
        audioControl.style.display = 'none';
    }
}

const sounds = {
    jump: { freq: 600, duration: 0.15, type: 'sine' },
    collect: { freq: 800, duration: 0.2, type: 'square' },
    shield: { freq: 1200, duration: 0.3, type: 'sine' },
    damage: { freq: 150, duration: 0.5, type: 'sawtooth' },
    gameOver: { freq: 100, duration: 1, type: 'sawtooth' },
    combo: { freq: 1000, duration: 0.1, type: 'sine' }
};

function playSound(soundName, volume = 0.3) {
    if (!audioEnabled || !audioContext) return;
    
    try {
        const sound = sounds[soundName];
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.value = sound.freq;
        oscillator.type = sound.type;
        
        gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + sound.duration);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + sound.duration);
    } catch(e) {
        console.log("Audio error:", e);
    }
}

function playBackgroundMusic() {
    if (!audioEnabled || !audioContext) return;
    
    try {
        stopBackgroundMusic();
        
        const notes = [262, 330, 392, 523, 659];
        let currentNote = 0;
        
        function playNextNote() {
            if (!audioEnabled || !backgroundMusic) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = notes[currentNote];
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.05, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
            
            currentNote = (currentNote + 1) % notes.length;
        }
        
        backgroundMusic = setInterval(playNextNote, 600);
    } catch(e) {
        console.log("Music error:", e);
    }
}

function stopBackgroundMusic() {
    if (backgroundMusic) {
        clearInterval(backgroundMusic);
        backgroundMusic = null;
    }
}

function toggleAudio() {
    audioEnabled = !audioEnabled;
    audioControl.textContent = audioEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
    
    if (audioEnabled && gameRunning) {
        playBackgroundMusic();
    } else {
        stopBackgroundMusic();
    }
}

// ==================== Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØ§Ù„Ø§Ù‡ØªØ²Ø§Ø² ====================
let cameraOffset = 0;
let shakeIntensity = 0;
let cameraFollow = true;

function screenShake(intensity, duration) {
    if (!gameRunning) return;
    
    shakeIntensity = intensity;
    shakeEffect.style.display = 'block';
    shakeEffect.style.background = `radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, transparent ${intensity * 10}%)`;
    
    setTimeout(() => {
        shakeIntensity = 0;
        shakeEffect.style.display = 'none';
    }, duration);
}

function updateCamera() {
    if (!cameraFollow || !gameRunning) return;
    
    const targetOffset = Math.max(0, canvas.width/2 - player.x - player.width/2);
    cameraOffset += (targetOffset - cameraOffset) * 0.1;
    
    if (shakeIntensity > 0) {
        cameraOffset += (Math.random() - 0.5) * shakeIntensity * 10;
    }
}

// ==================== Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ====================
let gameRunning = false;
let score = 0;
let coins = 0;
let highScore = localStorage.getItem('ultraJumpHighScore') || 0;
let speed = 4;
let lastTime = 0;
let obstacleTimer = 0;
let powerupTimer = 0;
let gameStartTime = 0;
let combo = 0;
let comboTimeout = 0;
let blinkTimer = 0;
let playerDead = false;

// ==================== ØªØ­Ø¬ÙŠÙ… Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ ====================
function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

// ==================== ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ø¹ Ø±Ø³ÙˆÙ… Ù…ØªØ­Ø±ÙƒØ© ====================
const player = {
    x: 100,
    y: 0,
    width: 50,
    height: 50,
    velocityY: 0,
    jumps: 0,
    maxJumps: 2,
    color: '#ff00ff',
    shield: false,
    magnet: false,
    doubleCoins: false,
    blinkState: 0,
    blinkTimer: 0,
    deathAnimation: 0,
    rotation: 0,
    scale: 1,
    trail: [],
    trailLength: 10
};

// ==================== Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø®Ø±Ù‰ ====================
let groundY = canvas.height - 120;
let obstacles = [];
let powerups = [];
let particles = [];
let stars = [];

// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø¬ÙˆÙ… ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
for (let i = 0; i < 100; i++) {
    stars.push({
        x: Math.random() * canvas.width * 3,
        y: Math.random() * canvas.height,
        size: Math.random() * 2 + 1,
        speed: Math.random() * 2 + 1,
        brightness: Math.random() * 0.8 + 0.2
    });
}

// ==================== Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚ÙØ² Ù…Ø¹ ØªØ£Ø«ÙŠØ±Ø§Øª ====================
function jump(e) {
    if (e) e.preventDefault();
    if (!gameRunning || playerDead) return;
    if (player.jumps < player.maxJumps) {
        player.velocityY = -18;
        player.jumps++;
        player.rotation = -0.3;
        
        playSound('jump', 0.4);
        createParticles(player.x + player.width/2, player.y + player.height, 15, '#ffff00', 2, 5);
        screenShake(2, 200);
        
        for(let i = 0; i < 5; i++) {
            player.trail.push({
                x: player.x,
                y: player.y,
                alpha: 0.5 - i * 0.1,
                width: player.width,
                height: player.height
            });
        }
    }
}

// ==================== Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª ====================
function createParticles(x, y, count, color, minSize = 1, maxSize = 4) {
    for (let i = 0; i < count; i++) {
        particles.push({
            x: x,
            y: y,
            vx: (Math.random() - 0.5) * 12,
            vy: (Math.random() - 0.5) * 8 - 8,
            life: 1,
            color: color,
            size: Math.random() * (maxSize - minSize) + minSize,
            gravity: 0.3,
            fade: 0.02
        });
    }
}

// ==================== Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª ====================
function createObstacle() {
    const types = [
        { width: 40, height: 60, color: '#ff0000', speedMod: 1 },
        { width: 60, height: 40, color: '#ff4444', speedMod: 1.2 },
        { width: 30, height: 80, color: '#ff8888', speedMod: 0.8 }
    ];
    
    const type = types[Math.floor(Math.random() * types.length)];
    const obstacle = {
        x: canvas.width + 100 - cameraOffset,
        y: groundY - type.height,
        width: type.width,
        height: type.height,
        color: type.color,
        speedMod: type.speedMod,
        glow: Math.random() < 0.2
    };
    
    obstacles.push(obstacle);
}

// ==================== Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù‚ÙˆÙ‰ ====================
function createPowerup() {
    const types = [
        { color: '#00ffff', type: 'shield', symbol: 'ğŸ›¡ï¸' },
        { color: '#ffff00', type: 'jump', symbol: 'ğŸ‘Ÿ' },
        { color: '#ff8800', type: 'magnet', symbol: 'ğŸ§²' },
        { color: '#00ff00', type: 'coins', symbol: 'ğŸ’°' }
    ];
    
    const type = types[Math.floor(Math.random() * types.length)];
    
    powerups.push({
        x: canvas.width + 150 - cameraOffset,
        y: groundY - 150 - Math.random() * 200,
        width: 30,
        height: 30,
        color: type.color,
        type: type.type,
        symbol: type.symbol,
        rotation: 0,
        pulse: 0
    });
}

// ==================== Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ====================
function update(deltaTime) {
    if (!gameRunning || playerDead) return;
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
    const currentTime = Date.now();
    if (!gameStartTime) gameStartTime = currentTime;
    const elapsedSeconds = Math.floor((currentTime - gameStartTime) / 1000);
    document.getElementById('time').textContent = 
        `${Math.floor(elapsedSeconds / 60).toString().padStart(2, '0')}:${(elapsedSeconds % 60).toString().padStart(2, '0')}`;
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ø¶
    groundY = canvas.height - 120;
    
    // Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡
    player.velocityY += 0.5;
    player.y += player.velocityY;
    
    // Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ø¨Ø§Ù„Ø£Ø±Ø¶
    if (player.y + player.height > groundY) {
        player.y = groundY - player.height;
        player.velocityY = 0;
        player.jumps = 0;
        player.rotation *= 0.9;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨
    player.rotation *= 0.95;
    
    // ØªØ­Ø¯ÙŠØ« ÙˆÙ…ÙŠØ¶ Ø§Ù„Ø¹ÙŠÙˆÙ†
    blinkTimer += deltaTime;
    if (blinkTimer > 3000) {
        player.blinkState = 1;
        if (blinkTimer > 3050) {
            player.blinkState = 0;
            blinkTimer = Math.random() * 2000;
        }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø°ÙŠÙ„
    player.trail.unshift({
        x: player.x,
        y: player.y,
        alpha: 0.5,
        width: player.width,
        height: player.height
    });
    
    if (player.trail.length > player.trailLength) {
        player.trail.pop();
    }
    
    for (let point of player.trail) {
        point.alpha *= 0.8;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¬ÙˆÙ…
    for (let star of stars) {
        star.x -= star.speed + speed * 0.5;
        if (star.x < -100) {
            star.x = canvas.width * 3;
            star.y = Math.random() * canvas.height;
        }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ù‚ØªØ§Øª
    obstacleTimer += deltaTime;
    powerupTimer += deltaTime;
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù‚Ø¨Ø§Øª
    if (obstacleTimer > 800 - Math.min(speed * 50, 600)) {
        if (Math.random() < 0.4) {
            createObstacle();
        }
        obstacleTimer = 0;
    }
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ù‚ÙˆÙ‰ Ø®Ø§ØµØ©
    if (powerupTimer > 1500) {
        if (Math.random() < 0.25) {
            createPowerup();
        }
        powerupTimer = 0;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª
    for (let i = obstacles.length - 1; i >= 0; i--) {
        obstacles[i].x -= speed * obstacles[i].speedMod;
        
        // ØªØµØ§Ø¯Ù… Ù…Ø¹ Ø§Ù„Ù„Ø§Ø¹Ø¨
        if (player.x < obstacles[i].x + obstacles[i].width &&
            player.x + player.width > obstacles[i].x &&
            player.y < groundY &&
            player.y + player.height > obstacles[i].y) {
            
            if (player.shield) {
                player.shield = false;
                player.color = '#ff00ff';
                obstacles.splice(i, 1);
                createParticles(player.x, player.y, 30, '#00ffff', 4, 8);
                playSound('shield', 0.5);
                screenShake(5, 300);
                score += 100;
                continue;
            }
            
            playerDeath();
            return;
        }
        
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚Ø¨Ø§Øª Ø®Ø§Ø±Ø¬ Ø§Ù„Ø´Ø§Ø´Ø©
        if (obstacles[i].x < -200 - cameraOffset) {
            obstacles.splice(i, 1);
        }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆÙ‰ Ø§Ù„Ø®Ø§ØµØ©
    for (let i = powerups.length - 1; i >= 0; i--) {
        powerups[i].x -= speed;
        powerups[i].rotation += 0.05;
        powerups[i].pulse = Math.sin(Date.now() * 0.005) * 0.2 + 1;
        
        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…ØºÙ†Ø§Ø·ÙŠØ³
        if (player.magnet) {
            const dx = player.x - powerups[i].x;
            const dy = player.y - powerups[i].y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < 250) {
                powerups[i].x += dx * 0.15;
                powerups[i].y += dy * 0.15;
            }
        }
        
        // Ø¬Ù…Ø¹ Ø§Ù„Ù‚ÙˆÙ‰ - Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø°ÙŠ ØªÙ… Ø¥ØµÙ„Ø§Ø­Ù‡
        if (player.x < powerups[i].x + powerups[i].width &&
            player.x + player.width > powerups[i].x &&
            player.y < powerups[i].y + powerups[i].height &&
            player.y + player.height > powerups[i].y) {
            
            collectPowerup(powerups[i]);
            powerups.splice(i, 1);
        }
        
                //
